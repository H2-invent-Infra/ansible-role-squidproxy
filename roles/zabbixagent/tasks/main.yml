---
# tasks file for zabbix-agent
  
- name: Install Zabbix Agent
  apt: pkg={{ zabbixagent_package }} state=installed update_cache=true
  register: zabbixagentinstalled
  
- name: Copy Zabbix Config
  when: zabbixagentinstalled|success
  copy: src={{ zabbixagent_source_config }} dest={{ zabbixagent_path }} owner=root group=root force=yes
  
- name: Insert Hostname to Zabbix Config
  when: zabbixagentinstalled|success
  lineinfile: dest={{ zabbixagent_conf }} insertafter="^# Hostname=" line="Hostname={{ ansible_hostname }}"
  
- debug: msg="Put this hostname {{ ansible_hostname }} to zabbix"